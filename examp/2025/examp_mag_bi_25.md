Перечень теоретических вопросов и практических заданий по курсу "Python для анализа данных".

***

## Теоретические вопросы (50 вопросов)

### Тема 0. Введение. Базовые элементы Python (10 вопросов)

1.  В каких задачах анализа данных предпочтительнее использовать словарь (`dict`), а не список (`list`)? Приведите бизнес-пример.
2.  Объясните разницу между изменяемыми (mutable) и неизменяемыми (immutable) типами данных в Python. Почему это важно при работе с `pandas`?
3.  Что такое "list comprehension" (списковое включение)? Приведите пример, как с его помощью можно рассчитать скидку для списка цен.
4.  Каково назначение функций в программировании? Опишите сценарий, когда в бизнес-аналитике целесообразно вынести расчет в отдельную функцию.
5.  Объясните, как работают условные операторы (`if/elif/else`). Приведите пример сегментации клиентов по сумме покупок с их помощью.
6.  В чем разница между циклами `for` и `while`? Какой из них лучше подходит для итерации по списку транзакций и почему?
7.  Что такое f-строки и как они используются для формирования отчетов или вывода результатов анализа?
8.  Какие основные методы для работы со строками в Python вы знаете и как их можно применить для очистки текстовых данных (например, названий товаров)?
9.  Опишите назначение типа данных `set` (множество). Приведите пример его использования для поиска уникальных ID клиентов из нескольких списков.
10. Какую роль играют комментарии в коде? Почему документирование кода является важной частью работы аналитика данных?

### Тема 1. Инструментарий аналитика: SQL и Pandas (10 вопросов)

1.  В чем ключевые различия между `pandas DataFrame` и SQL-таблицей с точки зрения аналитика?
2.  Опишите назначение команды `GROUP BY` в SQL. Какой метод в `pandas` является ее аналогом? Приведите пример для подсчета средней суммы чека по городам.
3.  Что такое `JOIN` в SQL? Перечислите основные типы `JOIN` (INNER, LEFT, RIGHT, FULL OUTER) и объясните, какой из них использовать для объединения таблицы клиентов и таблицы заказов, чтобы не потерять клиентов без заказов.
4.  Как в `pandas` выбрать строки по условию? Сравните фильтрацию с помощью `.loc`, `.iloc` и булевой индексации.
5.  Объясните назначение метода `.apply()` в `pandas`. Приведите бизнес-пример, когда его использование оправдано (например, применение сложной функции к столбцу).
6.  Что такое пропущенные значения (`NaN`) и какими методами в `pandas` их можно обнаружить и обработать (удалить, заполнить)?
7.  С какой целью используется метод `.pivot_table()` (сводная таблица) в `pandas`? Опишите, как с его помощью можно проанализировать продажи разных категорий товаров по месяцам.
8.  В чем разница между агрегирующими функциями (`SUM`, `AVG`, `COUNT`) и оконными функциями в SQL?
9.  Как создать новый вычисляемый столбец в `pandas DataFrame`? Приведите пример расчета рентабельности на основе столбцов "выручка" и "затраты".
10. Опишите процесс чтения данных из CSV-файла в `pandas DataFrame`. Какие основные параметры функции `pd.read_csv()` вы знаете?

### Тема 2. Исследовательский анализ (EDA) и визуализация бизнес-данных (10 вопросов)

1.  Какова основная цель исследовательского анализа данных (EDA) в контексте бизнес-задачи?
2.  Какой тип графика лучше всего подходит для визуализации динамики продаж компании по месяцам? Обоснуйте свой выбор.
3.  Что такое гистограмма и диаграмма плотности? Какую информацию о распределении цен на товары они могут дать аналитику?
4.  Объясните, что показывает диаграмма рассеяния (`scatter plot`). Какой бизнес-вывод можно сделать, если на диаграмме "расходы на рекламу vs. продажи" точки образуют восходящее облако?
5.  Что такое "ящик с усами" (`boxplot`)? Как с его помощью можно обнаружить выбросы в данных о времени доставки заказов?
6.  Дайте определение корреляции. Что означает коэффициент корреляции, равный `-0.9`, `0.1` и `0.85`?
7.  В каком случае для визуализации долей рынка используется круговая диаграмма (`pie chart`), а в каком — столбчатая диаграмма (`bar chart`)?
8.  Что такое матрица корреляций и как тепловая карта (`heatmap`) помогает в ее интерпретации?
9.  Перечислите основные описательные статистики, которые выводит метод `.describe()` в `pandas`. Какую пользу каждая из них несет для понимания бизнес-показателя (например, выручки)?
10. Зачем в процессе EDA проверять данные на наличие дубликатов? К каким последствиям может привести их наличие при расчете итоговых метрик?

### Тема 3. Анализ временных рядов и подготовка признаков (10 вопросов)

1.  Что такое временной ряд? Приведите 3 примера временных рядов из сферы бизнес-информатики.
2.  Объясните понятия "тренд", "сезонность" и "шум" в контексте временного ряда дневных посещений веб-сайта.
3.  Зачем преобразовывать строковые представления дат в формат `datetime` при работе с временными рядами в `pandas`?
4.  Что такое "скользящее среднее" (rolling mean) и для какой цели оно используется в анализе временных рядов (например, при анализе котировок акций)?
5.  Объясните суть "лаговых признаков" (lag features). Как признак "объем продаж за вчерашний день" может помочь в прогнозировании сегодняшних продаж?
6.  Что такое One-Hot Encoding и для каких типов признаков он применяется? Приведите пример для столбца "Регион" со значениями "Центр", "Юг", "Север".
7.  В чем разница между нормализацией (Min-Max scaling) и стандартизацией (Standard scaling) признаков? В каких случаях они применяются?
8.  Что такое ресэмплинг (resampling) временного ряда? Приведите пример, когда нужно преобразовать дневные данные о транзакциях в месячные агрегированные данные.
9.  Опишите, как извлечь из даты такие признаки, как "день недели", "месяц", "квартал", "год". Зачем это может понадобиться для построения предиктивной модели?
10. Что такое стационарность временного ряда и почему это важное свойство для некоторых прогностических моделей (например, ARIMA)?

### Тема 4. Построение и оценка предиктивных моделей (10 вопросов)

1.  В чем фундаментальное различие между задачами регрессии и задачами классификации? Приведите по одному бизнес-примеру для каждой.
2.  Зачем необходимо разделять данные на обучающую (`train`) и тестовую (`test`) выборки? Что произойдет, если оценивать модель на тех же данных, на которых она обучалась?
3.  Объясните понятия "переобучение" (overfitting) и "недообучение" (underfitting) модели.
4.  Что показывает метрика `Accuracy` в задаче классификации? В каком случае (приведите пример) `Accuracy` может быть высокой, но при этом вводить в заблуждение относительно качества модели?
5.  Объясните суть метрик `Precision` (точность) и `Recall` (полнота). Какая из них важнее в задаче предсказания оттока клиентов и в задаче медицинской диагностики опасного заболевания?
6.  Что такое `F1-score` и в каких ситуациях она является предпочтительной метрикой по сравнению с `Precision` и `Recall`?
7.  Какие метрики используются для оценки моделей регрессии? Объясните разницу между MAE (Mean Absolute Error) и MSE (Mean Squared Error).
8.  Что такое матрица ошибок (`confusion matrix`)? Объясните значение каждой из ее четырех ячеек (TP, FP, FN, TN).
9.  Опишите базовый принцип работы модели k-ближайших соседей (k-NN).
10. В чем разница между методами `model.predict()` и `model.predict_proba()` у моделей классификации в `scikit-learn`?

***

## Практические задания (100 постановок задач)

### Тема 0. Введение. Базовые элементы Python (20 заданий)

1.  Рассчитать общую сумму выручки по двум филиалам.
2.  Вычислить итоговую цену товара с учетом 15% скидки.
3.  Определить, является ли прибыль (разница выручки и затрат) положительной.
4.  Создать функцию, которая рассчитывает бонус менеджера (5% от продаж).
5.  Используя цикл `for`, вывести на экран список всех товаров.
6.  Найти в списке дневных продаж максимальное значение.
7.  Найти в списке дневных продаж минимальное значение.
8.  Объединить два списка с ID клиентов в один.
9.  Используя словарь, получить название отдела по его ID.
10. Сформировать строку отчета вида "Продажи за день: 15000 руб."
11. Подсчитать количество уникальных регионов в списке.
12. Проверить, входит ли товар "Ноутбук" в список проданных товаров.
13. Написать функцию, которая возвращает длину переданного ей списка.
14. Рассчитать средний балл по списку оценок клиентов.
15. Используя `if/else`, присвоить клиенту статус 'VIP' если его покупки превышают 50000, иначе 'Standard'.
16. Преобразовать строку с датой "2023-11-20" в список `['2023', '11', '20']`.
17. Написать цикл `while`, который "обслуживает" очередь, уменьшая счетчик клиентов с 5 до 0.
18. Создать словарь с информацией о сотруднике (имя, должность, стаж).
19. Получить из словаря `products` цену товара с ID `101`.
20. Написать функцию, которая принимает имя и фамилию и возвращает их, объединенные в одну строку через пробел.

### Тема 1. Инструментарий аналитика: SQL и Pandas (20 заданий)

1.  Из `DataFrame` с данными о сотрудниках выбрать столбец 'Фамилия'.
2.  Отфильтровать `DataFrame` заказов, оставив только те, где сумма превышает 1000.
3.  Рассчитать средний возраст клиентов из столбца 'age'.
4.  Создать новый столбец 'total_price' как произведение 'quantity' на 'price'.
5.  Сгруппировать данные по столбцу 'city' и посчитать суммарные продажи для каждого города.
6.  Отсортировать `DataFrame` товаров по столбцу 'price' по возрастанию.
7.  Подсчитать количество строк в `DataFrame` с транзакциями.
8.  Выбрать первые 10 строк из `DataFrame`.
9.  Переименовать столбец 'product_name' в 'item_name'.
10. Найти количество уникальных ID товаров в столбце 'product_id'.
11. Написать SQL-запрос для выбора всех полей из таблицы `employees`.
12. Написать SQL-запрос для выбора `name` и `email` из таблицы `customers` где `city = 'New York'`.
13. Написать SQL-запрос для подсчета общего количества заказов в таблице `orders`.
14. В `DataFrame` с пропусками в столбце 'income' заполнить их нулем.
15. Удалить столбец 'internal_notes' из `DataFrame`.
16. Выбрать строки `DataFrame` с индексами от 100 до 110.
17. С помощью `.loc` выбрать все строки, где значение в столбце 'category' равно 'Электроника'.
18. Сгруппировать данные по 'department' и найти максимальную зарплату в каждом отделе.
19. Объединить два `DataFrame` (клиенты и заказы) по столбцу `client_id`.
20. Написать SQL-запрос для выбора 5 самых дорогих товаров из таблицы `products`, отсортировав их по цене.

### Тема 2. Исследовательский анализ (EDA) и визуализация бизнес-данных (20 заданий)

1.  Рассчитать основные описательные статистики для столбца 'цена_товара'.
2.  Найти медианное значение времени доставки.
3.  Определить самый часто встречающийся способ оплаты.
4.  Подсчитать количество клиентов в каждом регионе.
5.  Найти 5 самых продаваемых товаров по количеству.
6.  Вычислить корреляцию между расходами на маркетинг и выручкой.
7.  Найти минимальную и максимальную сумму чека за день.
8.  Определить 75-й перцентиль для возраста клиентов.
9.  Вывести информацию о типах данных и наличии пропусков в `DataFrame`.
10. Посчитать количество дублирующихся строк в данных о заказах.
11. *Подготовить данные для гистограммы* распределения сумм заказов.
12. *Подготовить данные для столбчатой диаграммы*, показывающей количество товаров в каждой категории.
13. *Подготовить данные для линейного графика*, отражающего динамику выручки по дням.
14. *Подготовить данные для диаграммы рассеяния* между возрастом клиента и средней суммой его покупки.
15. *Подготовить данные для круговой диаграммы*, показывающей долю продаж по регионам.
16. Найти стандартное отклонение для дневных продаж.
17. Создать сводную таблицу для анализа средней оценки товара по категориям.
18. Определить диапазон (разницу между максимумом и минимумом) цен на товары.
19. Найти и вывести 3 самых редких города в списке клиентов.
20. Рассчитать суммарную выручку для топ-3 категорий товаров.

### Тема 3. Анализ временных рядов и подготовка признаков (20 заданий)

1.  Преобразовать столбец со строковыми датами 'order_date' в формат `datetime`.
2.  Установить столбец 'date' в качестве индекса `DataFrame`.
3.  Извлечь год из столбца с датой и создать новый признак 'year'.
4.  Извлечь месяц из столбца с датой и создать новый признак 'month'.
5.  Извлечь день недели из столбца с датой и создать новый признак 'weekday'.
6.  Рассчитать скользящее среднее с окном 7 для дневных продаж.
7.  Создать лаг-признак (сдвиг на 1) для показателя посещаемости сайта.
8.  Выполнить One-Hot Encoding для категориального столбца 'device_type' ('mobile', 'desktop', 'tablet').
9.  Преобразовать столбец 'priority' ('low', 'medium', 'high') в числовой формат (0, 1, 2) с помощью метода `.map()`.
10. Нормализовать столбец 'сумма_заказа' к диапазону (Min-Max Scaling).
11. Стандартизировать столбец 'возраст_клиента' (Standard Scaling).
12. Провести ресэмплинг данных о транзакциях из дневных в месячные, подсчитывая сумму.
13. Рассчитать процентное изменение ежедневной выручки.
14. Отфильтровать временной ряд, оставив данные только за 2023 год.
15. Создать признак "прошло дней с момента предыдущей покупки".
16. Извлечь квартал из столбца с датой и создать новый признак 'quarter'.
17. Создать бинарный признак 'is_weekend' (1, если день недели - выходной, иначе 0).
18. Заполнить пропуски во временном ряде предыдущим известным значением (forward fill).
19. Рассчитать разницу между текущим и предыдущим значением во временном ряде (`.diff()`).
20. Вычислить экспоненциально взвешенное скользящее среднее (EWMA) для временного ряда.

### Тема 4. Построение и оценка предиктивных моделей (20 заданий)

1.  Разделить признаки (X) и целевую переменную (y) на обучающую и тестовую выборки.
2.  Обучить модель линейной регрессии для предсказания цены квартиры.
3.  Сделать предсказание стоимости на тестовой выборке с помощью обученной модели регрессии.
4.  Рассчитать метрику MAE (Mean Absolute Error) между истинными и предсказанными ценами.
5.  Рассчитать метрику MSE (Mean Squared Error) для модели регрессии.
6.  Рассчитать метрику R² (коэффициент детерминации).
7.  Обучить модель логистической регрессии для предсказания оттока клиентов (1 - ушел, 0 - остался).
8.  Сделать предсказание класса (0 или 1) для тестовой выборки с помощью модели классификации.
9.  Рассчитать метрику `Accuracy` для модели предсказания оттока.
10. Рассчитать метрику `Precision` для класса "1" (отток).
11. Рассчитать метрику `Recall` для класса "1" (отток).
12. Рассчитать метрику `F1-score` для класса "1" (отток).
13. Построить матрицу ошибок (`confusion matrix`) для результатов классификации.
14. Получить предсказание вероятностей классов с помощью метода `.predict_proba()`.
15. Обучить модель k-ближайших соседей (k-NN) с k=5 для классификации клиентов.
16. Обучить модель дерева решений для задачи регрессии.
17. Обучить модель дерева решений для задачи классификации.
18. Разделить данные для временного ряда на обучающую и тестовую выборки без перемешивания.
19. Сравнить `Accuracy` двух моделей и определить, какая из них лучше.
20. Используя обученную модель регрессии, предсказать выручку для новых значений расходов на рекламу.








Ниже представлен **полный и исправленный набор из 75 задач**. Каждая задача теперь включает:
1.  **Постановку задачи.**
2.  **Шаблон для написания кода:** Полный, запускаемый скрипт, где студенту нужно заполнить только одну строку `...`.
3.  **Решение для преподавателя:** Готовый и работающий код.
4.  **Тесты:** Два набора проверочных входных данных и соответствующий им вывод для каждой задачи.

***

### **Тема 0. Введение. Базовые элементы Python**

**Задача 1**
*   **Постановка задачи:** Написать функцию `calculate_total_sales`, которая принимает два числа и возвращает их сумму.
*   **Шаблон для написания кода:**
    ```python
    def calculate_total_sales(sales_a, sales_b):
        total_sales = ...
        return total_sales

    # --- Код для проверки ---
    a = float(input())
    b = float(input())
    print(calculate_total_sales(a, b))
    ```
*   **Решение для преподавателя:**
    ```python
    def calculate_total_sales(sales_a, sales_b):
        total_sales = sales_a + sales_b
        return total_sales

    # --- Код для проверки ---
    a = float(input())
    b = float(input())
    print(calculate_total_sales(a, b))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `1500\n2300` -> Output: `3800.0`
    *   **Тест 2:** Input: `10.5\n-5.5` -> Output: `5.0`

**Задача 2**
*   **Постановка задачи:** Написать функцию `is_plan_completed`, которая принимает плановое и фактическое значения и возвращает `True`, если план выполнен.
*   **Шаблон для написания кода:**
    ```python
    def is_plan_completed(plan, fact):
        return ...

    # --- Код для проверки ---
    plan_value = float(input())
    fact_value = float(input())
    print(is_plan_completed(plan_value, fact_value))
    ```
*   **Решение для преподавателя:**
    ```python
    def is_plan_completed(plan, fact):
        return fact >= plan

    # --- Код для проверки ---
    plan_value = float(input())
    fact_value = float(input())
    print(is_plan_completed(plan_value, fact_value))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `10000\n10500` -> Output: `True`
    *   **Тест 2:** Input: `10000\n9999` -> Output: `False`

**Задача 3**
*   **Постановка задачи:** Написать функцию `get_manager_names`, которая принимает список и возвращает его.
*   **Шаблон для написания кода:**
    ```python
    def get_manager_names(managers_list):
        active_managers = ...
        return active_managers

    # --- Код для проверки ---
    names = input().split()
    print(get_manager_names(names))
    ```
*   **Решение для преподавателя:**
    ```python
    def get_manager_names(managers_list):
        active_managers = managers_list
        return active_managers

    # --- Код для проверки ---
    names = input().split()
    print(get_manager_names(names))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `Анна Петр` -> Output: `['Анна', 'Петр']`
    *   **Тест 2:** Input: `Сергей` -> Output: `['Сергей']`

**Задача 4**
*   **Постановка задачи:** Написать функцию `calculate_discount_amount`, которая принимает цену и процент скидки, а возвращает сумму скидки.
*   **Шаблон для написания кода:**
    ```python
    def calculate_discount_amount(price, discount_percent):
        discount_amount = ...
        return discount_amount

    # --- Код для проверки ---
    p = float(input())
    d = float(input())
    print(calculate_discount_amount(p, d))
    ```
*   **Решение для преподавателя:**
    ```python
    def calculate_discount_amount(price, discount_percent):
        discount_amount = price * (discount_percent / 100)
        return discount_amount

    # --- Код для проверки ---
    p = float(input())
    d = float(input())
    print(calculate_discount_amount(p, d))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `1000\n10` -> Output: `100.0`
    *   **Тест 2:** Input: `500\n20` -> Output: `100.0`

**Задача 5**
*   **Постановка задачи:** Написать функцию `get_product_name_by_id`, которая принимает словарь и ID, а возвращает название товара.
*   **Шаблон для написания кода:**
    ```python
    def get_product_name_by_id(products_dict, product_id):
        product_name = products_dict[...]
        return product_name

    # --- Код для проверки ---
    products = {1: "Ноутбук", 2: "Мышь", 3: "Клавиатура"}
    pid = int(input())
    print(get_product_name_by_id(products, pid))
    ```
*   **Решение для преподавателя:**
    ```python
    def get_product_name_by_id(products_dict, product_id):
        product_name = products_dict[product_id]
        return product_name

    # --- Код для проверки ---
    products = {1: "Ноутбук", 2: "Мышь", 3: "Клавиатура"}
    pid = int(input())
    print(get_product_name_by_id(products, pid))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `2` -> Output: `Мышь`
    *   **Тест 2:** Input: `3` -> Output: `Клавиатура`

**Задача 6**
*   **Постановка задачи:** Написать функцию `format_order_string`, которая принимает ID заказа и сумму и возвращает отформатированную строку.
*   **Шаблон для написания кода:**
    ```python
    def format_order_string(order_id, amount):
        order_info = f"Заказ №{...} на сумму {...}"
        return order_info

    # --- Код для проверки ---
    oid = int(input())
    amt = float(input())
    print(format_order_string(oid, amt))
    ```
*   **Решение для преподавателя:**
    ```python
    def format_order_string(order_id, amount):
        order_info = f"Заказ №{order_id} на сумму {amount}"
        return order_info

    # --- Код для проверки ---
    oid = int(input())
    amt = float(input())
    print(format_order_string(oid, amt))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `123\n4500.5` -> Output: `Заказ №123 на сумму 4500.5`
    *   **Тест 2:** Input: `99\n100.0` -> Output: `Заказ №99 на сумму 100.0`

**Задача 7**
*   **Постановка задачи:** Написать функцию `count_unique_categories`, которая принимает список и возвращает количество уникальных элементов.
*   **Шаблон для написания кода:**
    ```python
    def count_unique_categories(categories_list):
        unique_count = len(set(...))
        return unique_count

    # --- Код для проверки ---
    categories = input().split()
    print(count_unique_categories(categories))
    ```
*   **Решение для преподавателя:**
    ```python
    def count_unique_categories(categories_list):
        unique_count = len(set(categories_list))
        return unique_count

    # --- Код для проверки ---
    categories = input().split()
    print(count_unique_categories(categories))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `A B A C B` -> Output: `3`
    *   **Тест 2:** Input: `X X X Y` -> Output: `2`

**Задача 8**
*   **Постановка задачи:** Написать функцию `is_positive`, которая принимает число и возвращает `True`, если оно положительное.
*   **Шаблон для написания кода:**
    ```python
    def is_positive(number):
        return ...

    # --- Код для проверки ---
    num = float(input())
    print(is_positive(num))
    ```
*   **Решение для преподавателя:**
    ```python
    def is_positive(number):
        return number > 0

    # --- Код для проверки ---
    num = float(input())
    print(is_positive(num))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `10` -> Output: `True`
    *   **Тест 2:** Input: `-5` -> Output: `False`

**Задача 9**
*   **Постановка задачи:** Написать функцию `merge_client_lists`, которая принимает два списка и возвращает их объединенную версию.
*   **Шаблон для написания кода:**
    ```python
    def merge_client_lists(list1, list2):
        all_clients = ...
        return all_clients

    # --- Код для проверки ---
    l1 = input().split()
    l2 = input().split()
    print(merge_client_lists(l1, l2))
    ```
*   **Решение для преподавателя:**
    ```python
    def merge_client_lists(list1, list2):
        all_clients = list1 + list2
        return all_clients

    # --- Код для проверки ---
    l1 = input().split()
    l2 = input().split()
    print(merge_client_lists(l1, l2))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `1 2\n3 4` -> Output: `['1', '2', '3', '4']`
    *   **Тест 2:** Input: `A\nB C` -> Output: `['A', 'B', 'C']`

**Задача 10**
*   **Постановка задачи:** Написать функцию `get_last_sale`, которая принимает список и возвращает его последний элемент.
*   **Шаблон для написания кода:**
    ```python
    def get_last_sale(sales_list):
        last_sale = sales_list[...]
        return last_sale

    # --- Код для проверки ---
    sales = [float(s) for s in input().split()]
    print(get_last_sale(sales))
    ```
*   **Решение для преподавателя:**
    ```python
    def get_last_sale(sales_list):
        last_sale = sales_list[-1]
        return last_sale

    # --- Код для проверки ---
    sales = [float(s) for s in input().split()]
    print(get_last_sale(sales))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `100 120 150` -> Output: `150.0`
    *   **Тест 2:** Input: `10` -> Output: `10.0`

**Задача 11**
*   **Постановка задачи:** Написать функцию `calculate_profit`, которая принимает выручку и затраты и возвращает прибыль.
*   **Шаблон для написания кода:**
    ```python
    def calculate_profit(revenue, costs):
        profit = ...
        return profit

    # --- Код для проверки ---
    rev = float(input())
    cst = float(input())
    print(calculate_profit(rev, cst))
    ```
*   **Решение для преподавателя:**
    ```python
    def calculate_profit(revenue, costs):
        profit = revenue - costs
        return profit

    # --- Код для проверки ---
    rev = float(input())
    cst = float(input())
    print(calculate_profit(rev, cst))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `10000\n8000` -> Output: `2000.0`
    *   **Тест 2:** Input: `500\n700` -> Output: `-200.0`

**Задача 12**
*   **Постановка задачи:** Написать функцию `get_first_manager`, которая принимает список и возвращает его первый элемент.
*   **Шаблон для написания кода:**
    ```python
    def get_first_manager(managers):
        first = managers[...]
        return first

    # --- Код для проверки ---
    manager_list = input().split()
    print(get_first_manager(manager_list))
    ```
*   **Решение для преподавателя:**
    ```python
    def get_first_manager(managers):
        first = managers[0]
        return first

    # --- Код для проверки ---
    manager_list = input().split()
    print(get_first_manager(manager_list))
    ```*   **Тесты:**
    *   **Тест 1:** Input: `Анна Петр Сергей` -> Output: `Анна`
    *   **Тест 2:** Input: `Мария` -> Output: `Мария`

**Задача 13**
*   **Постановка задачи:** Написать функцию `check_vip_status`, которая принимает строку и возвращает `True`, если в ней есть подстрока "VIP".
*   **Шаблон для написания кода:**
    ```python
    def check_vip_status(status_string):
        is_vip = "VIP" in ...
        return is_vip

    # --- Код для проверки ---
    status = input()
    print(check_vip_status(status))
    ```
*   **Решение для преподавателя:**
    ```python
    def check_vip_status(status_string):
        is_vip = "VIP" in status_string
        return is_vip

    # --- Код для проверки ---
    status = input()
    print(check_vip_status(status))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `Super VIP client` -> Output: `True`
    *   **Тест 2:** Input: `Standard client` -> Output: `False`

**Задача 14**
*   **Постановка задачи:** Написать функцию `get_list_length`, которая принимает список и возвращает его длину.
*   **Шаблон для написания кода:**
    ```python
    def get_list_length(items_list):
        count = len(...)
        return count

    # --- Код для проверки ---
    items = input().split()
    print(get_list_length(items))
    ```
*   **Решение для преподавателя:**
    ```python
    def get_list_length(items_list):
        count = len(items_list)
        return count

    # --- Код для проверки ---
    items = input().split()
    print(get_list_length(items))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `A B C` -> Output: `3`
    *   **Тест 2:** Input: `SingleItem` -> Output: `1`

**Задача 15**
*   **Постановка задачи:** Написать функцию `calculate_price_with_tax`, которая принимает цену и добавляет к ней налог 20%.
*   **Шаблон для написания кода:**
    ```python
    def calculate_price_with_tax(price):
        final_price = ...
        return final_price

    # --- Код для проверки ---
    p = float(input())
    print(calculate_price_with_tax(p))
    ```
*   **Решение для преподавателя:**
    ```python
    def calculate_price_with_tax(price):
        final_price = price * 1.20
        return final_price

    # --- Код для проверки ---
    p = float(input())
    print(calculate_price_with_tax(p))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `100` -> Output: `120.0`
    *   **Тест 2:** Input: `50` -> Output: `60.0`

***

### **Тема 1. Инструментарий аналитика: SQL и Pandas**

**Задача 1**
*   **Постановка задачи:** Написать функцию `select_city_column`, которая принимает DataFrame и возвращает столбец 'city'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def select_city_column(df):
        cities = df[...]
        return cities

    # --- Код для проверки ---
    data = {'city': ['Москва', 'СПб', 'Казань'], 'population': [12.5, 5.4, 1.2]}
    df = pd.DataFrame(data)
    print(select_city_column(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def select_city_column(df):
        cities = df['city']
        return cities

    # --- Код для проверки ---
    data = {'city': ['Москва', 'СПб', 'Казань'], 'population': [12.5, 5.4, 1.2]}
    df = pd.DataFrame(data)
    print(select_city_column(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0     Москва\n1        СПб\n2     Казань\nName: city, dtype: object`
    *   **Тест 2:** (в коде изменить данные на `{'city': ['Омск'], 'population': [1.1]}`) -> Output: `0    Омск\nName: city, dtype: object`

**Задача 2**
*   **Постановка задачи:** Написать функцию `filter_sales`, которая принимает DataFrame и порог `value`, и возвращает строки, где продажи (`sales`) больше этого порога.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def filter_sales(df, value):
        filtered_df = df[df['sales'] > ...]
        return filtered_df

    # --- Код для проверки ---
    data = {'product': ['A', 'B', 'C'], 'sales': [120, 80, 150]}
    df = pd.DataFrame(data)
    threshold = int(input())
    print(filter_sales(df, threshold))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def filter_sales(df, value):
        filtered_df = df[df['sales'] > value]
        return filtered_df

    # --- Код для проверки ---
    data = {'product': ['A', 'B', 'C'], 'sales': [120, 80, 150]}
    df = pd.DataFrame(data)
    threshold = int(input())
    print(filter_sales(df, threshold))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `100` -> Output: `  product  sales\n0       A    120\n2       C    150`
    *   **Тест 2:** Input: `130` -> Output: `  product  sales\n2       C    150`

**Задача 3**
*   **Постановка задачи:** Написать функцию `calculate_mean_price`, которая возвращает среднее по столбцу 'price'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def calculate_mean_price(df):
        mean_price = df['price']. ...
        return mean_price

    # --- Код для проверки ---
    prices_str = input().split()
    data = {'price': [float(p) for p in prices_str]}
    df = pd.DataFrame(data)
    print(calculate_mean_price(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def calculate_mean_price(df):
        mean_price = df['price'].mean()
        return mean_price

    # --- Код для проверки ---
    prices_str = input().split()
    data = {'price': [float(p) for p in prices_str]}
    df = pd.DataFrame(data)
    print(calculate_mean_price(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `10 20 30` -> Output: `20.0`
    *   **Тест 2:** Input: `100 150` -> Output: `125.0`

**Задача 4**
*   **Постановка задачи:** Написать функцию `add_revenue_column`, которая создает столбец 'revenue' как произведение 'price' на 'quantity'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def add_revenue_column(df):
        df['revenue'] = ...
        return df

    # --- Код для проверки ---
    data = {'price': [10, 20, 30], 'quantity': [5, 10, 3]}
    df = pd.DataFrame(data)
    print(add_revenue_column(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def add_revenue_column(df):
        df['revenue'] = df['price'] * df['quantity']
        return df

    # --- Код для проверки ---
    data = {'price': [10, 20, 30], 'quantity': [5, 10, 3]}
    df = pd.DataFrame(data)
    print(add_revenue_column(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `   price  quantity  revenue\n0     10         5       50\n1     20        10      200\n2     30         3       90`
    *   **Тест 2:** (в коде изменить `quantity` на `[1, 1, 1]`) -> Output: `   price  quantity  revenue\n0     10         1       10\n1     20         1       20\n2     30         1       30`

**Задача 5**
*   **Постановка задачи:** Написать функцию `group_sales_by_category`, которая группирует DataFrame по 'category' и возвращает сумму продаж.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def group_sales_by_category(df):
        grouped_sales = df.groupby('...')['sales'].sum()
        return grouped_sales

    # --- Код для проверки ---
    data = {'category': ['A', 'B', 'A', 'B'], 'sales': [100, 150, 200, 50]}
    df = pd.DataFrame(data)
    print(group_sales_by_category(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def group_sales_by_category(df):
        grouped_sales = df.groupby('category')['sales'].sum()
        return grouped_sales

    # --- Код для проверки ---
    data = {'category': ['A', 'B', 'A', 'B'], 'sales': [100, 150, 200, 50]}
    df = pd.DataFrame(data)
    print(group_sales_by_category(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `category\nA    300\nB    200\nName: sales, dtype: int64`
    *   **Тест 2:** (в коде добавить `{'category': 'C', 'sales': 500}`) -> Output: `category\nA    300\nB    200\nC    500\nName: sales, dtype: int64`

**Задача 6**
*   **Постановка задачи:** Написать функцию `sort_by_revenue`, которая сортирует DataFrame по столбцу 'revenue' по убыванию.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def sort_by_revenue(df):
        sorted_df = df.sort_values(by='revenue', ascending=...)
        return sorted_df

    # --- Код для проверки ---
    data = {'product': ['A', 'B', 'C'], 'revenue': [500, 1000, 200]}
    df = pd.DataFrame(data)
    print(sort_by_revenue(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def sort_by_revenue(df):
        sorted_df = df.sort_values(by='revenue', ascending=False)
        return sorted_df

    # --- Код для проверки ---
    data = {'product': ['A', 'B', 'C'], 'revenue': [500, 1000, 200]}
    df = pd.DataFrame(data)
    print(sort_by_revenue(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `  product  revenue\n1       B     1000\n0       A      500\n2       C      200`
    *   **Тест 2:** (в коде изменить `revenue` на `[9, 8, 10]`) -> Output: `  product  revenue\n2       C       10\n0       A        9\n1       B        8`

**Задача 7**
*   **Постановка задачи:** Написать функцию `get_row_count`, которая возвращает количество строк в DataFrame.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_row_count(df):
        num_rows = len(...)
        return num_rows

    # --- Код для проверки ---
    data = {'id': [1, 2, 3, 4, 5]}
    df = pd.DataFrame(data)
    print(get_row_count(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_row_count(df):
        num_rows = len(df)
        return num_rows

    # --- Код для проверки ---
    data = {'id': [1, 2, 3, 4, 5]}
    df = pd.DataFrame(data)
    print(get_row_count(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде с 5 строками) -> Output: `5`
    *   **Тест 2:** (в коде изменить данные на `{'id': [1]}`) -> Output: `1`

**Задача 8**
*   **Постановка задачи:** Написать функцию `get_first_n_rows`, которая принимает DataFrame и число `n` и возвращает первые `n` строк.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_first_n_rows(df, n):
        first_n = df. ... (n)
        return first_n

    # --- Код для проверки ---
    data = {'id': range(10)}
    df = pd.DataFrame(data)
    n_rows = int(input())
    print(get_first_n_rows(df, n_rows))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_first_n_rows(df, n):
        first_n = df.head(n)
        return first_n

    # --- Код для проверки ---
    data = {'id': range(10)}
    df = pd.DataFrame(data)
    n_rows = int(input())
    print(get_first_n_rows(df, n_rows))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `3` -> Output: `   id\n0   0\n1   1\n2   2`
    *   **Тест 2:** Input: `5` -> Output: `   id\n0   0\n1   1\n2   2\n3   3\n4   4`

**Задача 9**
*   **Постановка задачи:** Написать функцию `rename_user_name_column`, которая переименовывает столбец 'user_name' в 'client_name'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def rename_user_name_column(df):
        df_renamed = df.rename(columns={'...': 'client_name'})
        return df_renamed

    # --- Код для проверки ---
    data = {'user_name': ['Иван', 'Анна'], 'age': [25, 30]}
    df = pd.DataFrame(data)
    print(rename_user_name_column(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def rename_user_name_column(df):
        df_renamed = df.rename(columns={'user_name': 'client_name'})
        return df_renamed

    # --- Код для проверки ---
    data = {'user_name': ['Иван', 'Анна'], 'age': [25, 30]}
    df = pd.DataFrame(data)
    print(rename_user_name_column(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `  client_name  age\n0        Иван   25\n1        Анна   30`
    *   **Тест 2:** (в коде изменить 'user_name' на 'customer_name' и `...` на 'customer_name') -> Output: `  client_name  age\n0        Иван   25\n1        Анна   30`

**Задача 10**
*   **Постановка задачи:** Написать функцию `count_unique_regions`, которая возвращает количество уникальных значений в столбце 'region'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def count_unique_regions(df):
        unique_count = df['region']. ...
        return unique_count

    # --- Код для проверки ---
    data = {'region': ['Центр', 'Юг', 'Центр', 'Север', 'Юг']}
    df = pd.DataFrame(data)
    print(count_unique_regions(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def count_unique_regions(df):
        unique_count = df['region'].nunique()
        return unique_count

    # --- Код для проверки ---
    data = {'region': ['Центр', 'Юг', 'Центр', 'Север', 'Юг']}
    df = pd.DataFrame(data)
    print(count_unique_regions(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `3`
    *   **Тест 2:** (в коде изменить данные на `{'region': ['A', 'A', 'A']}`) -> Output: `1`

**Задача 11**
*   **Постановка задачи:** Написать функцию `get_all_users_query`, которая возвращает SQL-запрос для выбора всех полей из таблицы `users`.
*   **Шаблон для написания кода:**
    ```python
    def get_all_users_query():
        query = "SELECT ... FROM users"
        return query

    # --- Код для проверки ---
    print(get_all_users_query())
    ```
*   **Решение для преподавателя:**
    ```python
    def get_all_users_query():
        query = "SELECT * FROM users"
        return query

    # --- Код для проверки ---
    print(get_all_users_query())
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (нет) -> Output: `SELECT * FROM users`
    *   **Тест 2:** Input: (нет) -> Output: `SELECT * FROM users`

**Задача 12**
*   **Постановка задачи:** Написать функцию `get_moscow_clients_query`, которая возвращает SQL-запрос для выбора `name`, `email` из таблицы `clients` для города 'Москва'.
*   **Шаблон для написания кода:**
    ```python
    def get_moscow_clients_query():
        query = "SELECT name, email FROM clients WHERE ... = 'Москва'"
        return query

    # --- Код для проверки ---
    print(get_moscow_clients_query())
    ```
*   **Решение для преподавателя:**
    ```python
    def get_moscow_clients_query():
        query = "SELECT name, email FROM clients WHERE city = 'Москва'"
        return query

    # --- Код для проверки ---
    print(get_moscow_clients_query())
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (нет) -> Output: `SELECT name, email FROM clients WHERE city = 'Москва'`
    *   **Тест 2:** Input: (нет) -> Output: `SELECT name, email FROM clients WHERE city = 'Москва'`

**Задача 13**
*   **Постановка задачи:** Написать функцию `get_orders_count_query`, которая возвращает SQL-запрос для подсчета количества записей в таблице `orders`.
*   **Шаблон для написания кода:**
    ```python
    def get_orders_count_query():
        query = "SELECT COUNT(...) FROM orders"
        return query

    # --- Код для проверки ---
    print(get_orders_count_query())
    ```
*   **Решение для преподавателя:**
    ```python
    def get_orders_count_query():
        query = "SELECT COUNT(*) FROM orders"
        return query

    # --- Код для проверки ---
    print(get_orders_count_query())
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (нет) -> Output: `SELECT COUNT(*) FROM orders`
    *   **Тест 2:** Input: (нет) -> Output: `SELECT COUNT(*) FROM orders`

**Задача 14**
*   **Постановка задачи:** Написать функцию `get_max_sale`, которая возвращает максимальное значение в столбце 'sales'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_max_sale(df):
        max_value = df['sales']. ...
        return max_value

    # --- Код для проверки ---
    data = {'sales': [120, 80, 150, 200, 95]}
    df = pd.DataFrame(data)
    print(get_max_sale(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_max_sale(df):
        max_value = df['sales'].max()
        return max_value

    # --- Код для проверки ---
    data = {'sales': [120, 80, 150, 200, 95]}
    df = pd.DataFrame(data)
    print(get_max_sale(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `200`
    *   **Тест 2:** (в коде изменить данные на `{'sales': [10, 20, 5]}`) -> Output: `20`

**Задача 15**
*   **Постановка задачи:** Написать функцию `drop_temp_column`, которая удаляет столбец 'temp_id' из DataFrame.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def drop_temp_column(df):
        df_dropped = df.drop(columns=[...])
        return df_dropped

    # --- Код для проверки ---
    data = {'user_id': [101, 102], 'temp_id': [99, 98], 'status': ['A', 'B']}
    df = pd.DataFrame(data)
    print(drop_temp_column(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def drop_temp_column(df):
        df_dropped = df.drop(columns=['temp_id'])
        return df_dropped

    # --- Код для проверки ---
    data = {'user_id': [101, 102], 'temp_id': [99, 98], 'status': ['A', 'B']}
    df = pd.DataFrame(data)
    print(drop_temp_column(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `   user_id status\n0      101      A\n1      102      B`
    *   **Тест 2:** (в коде изменить 'temp_id' на 'extra_id' и `...` на 'extra_id') -> Output: `   user_id status\n0      101      A\n1      102      B`

***

### **Тема 2. EDA и визуализация**

**Задача 1**
*   **Постановка задачи:** Написать функцию `get_price_distribution` для подсчета вхождений в столбце 'price'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_price_distribution(df):
        distribution = df['price']. ...
        return distribution

    # --- Код для проверки ---
    prices_str = input().split()
    data = {'price': [int(p) for p in prices_str]}
    df = pd.DataFrame(data)
    print(get_price_distribution(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_price_distribution(df):
        distribution = df['price'].value_counts()
        return distribution

    # --- Код для проверки ---
    prices_str = input().split()
    data = {'price': [int(p) for p in prices_str]}
    df = pd.DataFrame(data)
    print(get_price_distribution(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `100 120 100` -> Output: `price\n100    2\n120    1\nName: count, dtype: int64`
    *   **Тест 2:** Input: `50 50 50 80` -> Output: `price\n50    3\n80    1\nName: count, dtype: int64`

**Задача 2**
*   **Постановка задачи:** Написать функцию `get_revenue_stats`, которая возвращает статистику (`.describe()`) для столбца 'revenue'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_revenue_stats(df):
        description = df['revenue']. ...
        return description

    # --- Код для проверки ---
    data = {'revenue': [1000, 1200, 900, 1500, 1150]}
    df = pd.DataFrame(data)
    print(get_revenue_stats(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_revenue_stats(df):
        description = df['revenue'].describe()
        return description

    # --- Код для проверки ---
    data = {'revenue': [1000, 1200, 900, 1500, 1150]}
    df = pd.DataFrame(data)
    print(get_revenue_stats(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: (стандартный вывод `.describe()`)
    *   **Тест 2:** (в коде изменить данные на `{'revenue': [10, 20]}`) -> Output: (вывод `.describe()` для 10 и 20)

**Задача 3**
*   **Постановка задачи:** Написать функцию `calculate_correlation`, которая возвращает корреляцию между 'price' и 'rating'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def calculate_correlation(df):
        correlation = df['price']. ... (df['rating'])
        return correlation

    # --- Код для проверки ---
    data = {'price': [10, 20, 30, 40], 'rating': [4.5, 4.0, 3.8, 3.5]}
    df = pd.DataFrame(data)
    print(calculate_correlation(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def calculate_correlation(df):
        correlation = df['price'].corr(df['rating'])
        return correlation

    # --- Код для проверки ---
    data = {'price': [10, 20, 30, 40], 'rating': [4.5, 4.0, 3.8, 3.5]}
    df = pd.DataFrame(data)
    print(calculate_correlation(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `-0.9821...`
    *   **Тест 2:** (в коде изменить `rating` на `[1, 2, 3, 4]`, т.е. прямая зависимость) -> Output: `1.0`

**Задача 4**
*   **Постановка задачи:** Написать функцию `get_quantile_value`, которая возвращает 95-й перцентиль для столбца 'time'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_quantile_value(df):
        p95 = df['time']. ... (0.95)
        return p95

    # --- Код для проверки ---
    data = {'time': [10, 12, 9, 15, 11, 25, 8, 13]}
    df = pd.DataFrame(data)
    print(get_quantile_value(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_quantile_value(df):
        p95 = df['time'].quantile(0.95)
        return p95

    # --- Код для проверки ---
    data = {'time': [10, 12, 9, 15, 11, 25, 8, 13]}
    df = pd.DataFrame(data)
    print(get_quantile_value(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `21.5`
    *   **Тест 2:** (в коде изменить данные на `{'time': [1, 2, 3, 100]}`) -> Output: `75.75`

**Задача 5**
*   **Постановка задачи:** Написать функцию `get_most_common_payment`, которая возвращает самый частый способ оплаты.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_most_common_payment(df):
        most_common = df['payment_method']. ... [0]
        return most_common

    # --- Код для проверки ---
    data = {'payment_method': ['card', 'cash', 'card', 'card', 'online', 'cash']}
    df = pd.DataFrame(data)
    print(get_most_common_payment(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_most_common_payment(df):
        most_common = df['payment_method'].mode()[0]
        return most_common

    # --- Код для проверки ---
    data = {'payment_method': ['card', 'cash', 'card', 'card', 'online', 'cash']}
    df = pd.DataFrame(data)
    print(get_most_common_payment(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `card`
    *   **Тест 2:** (в коде изменить данные на `{'payment_method': ['online', 'online', 'card']}`) -> Output: `online`

**Задача 6**
*   **Постановка задачи:** Написать функцию `get_df_info_dtypes`, которая возвращает типы данных столбцов DataFrame.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_df_info_dtypes(df):
        info = df. ...
        return info

    # --- Код для проверки ---
    data = {'col1': [1, 2], 'col2': [3.0, 4.5], 'col3': ['A', 'B']}
    df = pd.DataFrame(data)
    print(get_df_info_dtypes(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_df_info_dtypes(df):
        info = df.dtypes
        return info

    # --- Код для проверки ---
    data = {'col1': [1, 2], 'col2': [3.0, 4.5], 'col3': ['A', 'B']}
    df = pd.DataFrame(data)
    print(get_df_info_dtypes(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `col1      int64\ncol2    float64\ncol3     object\ndtype: object`
    *   **Тест 2:** (в коде изменить данные на `{'id': [1], 'is_active': [True]}`) -> Output: `id             int64\nis_active       bool\ndtype: object`

**Задача 7**
*   **Постановка задачи:** Написать функцию `get_correlation_matrix`, которая возвращает матрицу корреляций.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_correlation_matrix(df):
        corr_matrix = df. ... ()
        return corr_matrix

    # --- Код для проверки ---
    data = {'a': [1, 2, 3, 4], 'b': [4, 3, 2, 1], 'c': [1, 3, 2, 4]}
    df = pd.DataFrame(data)
    print(get_correlation_matrix(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_correlation_matrix(df):
        corr_matrix = df.corr()
        return corr_matrix

    # --- Код для проверки ---
    data = {'a': [1, 2, 3, 4], 'b': [4, 3, 2, 1], 'c': [1, 3, 2, 4]}
    df = pd.DataFrame(data)
    print(get_correlation_matrix(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: (матрица корреляций 3x3)
    *   **Тест 2:** (в коде изменить данные на `{'x': [1, 2], 'y': [1, 2]}`) -> Output: `     x    y\nx  1.0  1.0\ny  1.0  1.0`

**Задача 8**
*   **Постановка задачи:** Написать функцию `get_min_revenue`, которая возвращает минимальное значение в столбце 'revenue'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_min_revenue(df):
        min_revenue = df['revenue']. ... ()
        return min_revenue

    # --- Код для проверки ---
    data = {'revenue': [1000, 2500, 950, 1800]}
    df = pd.DataFrame(data)
    print(get_min_revenue(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_min_revenue(df):
        min_revenue = df['revenue'].min()
        return min_revenue

    # --- Код для проверки ---
    data = {'revenue': [1000, 2500, 950, 1800]}
    df = pd.DataFrame(data)
    print(get_min_revenue(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `950`
    *   **Тест 2:** (в коде изменить данные на `{'revenue': [-100, 0, 100]}`) -> Output: `-100`

**Задача 9**
*   **Постановка задачи:** Написать функцию `get_median_age`, которая возвращает медианный возраст.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_median_age(df):
        median_age = df['age']. ... ()
        return median_age

    # --- Код для проверки ---
    data = {'age': [25, 30, 22, 45, 38]}
    df = pd.DataFrame(data)
    print(get_median_age(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_median_age(df):
        median_age = df['age'].median()
        return median_age

    # --- Код для проверки ---
    data = {'age': [25, 30, 22, 45, 38]}
    df = pd.DataFrame(data)
    print(get_median_age(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде, 5 элементов) -> Output: `30.0`
    *   **Тест 2:** (в коде изменить данные на `{'age': [10, 20, 30, 40]}`) -> Output: `25.0`

**Задача 10**
*   **Постановка задачи:** Написать функцию `get_sum_sales`, которая возвращает общую сумму продаж.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_sum_sales(df):
        total_sales = df['sales']. ... ()
        return total_sales

    # --- Код для проверки ---
    data = {'sales': [120, 80, 150, 200, 95]}
    df = pd.DataFrame(data)
    print(get_sum_sales(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_sum_sales(df):
        total_sales = df['sales'].sum()
        return total_sales

    # --- Код для проверки ---
    data = {'sales': [120, 80, 150, 200, 95]}
    df = pd.DataFrame(data)
    print(get_sum_sales(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `645`
    *   **Тест 2:** (в коде изменить данные на `{'sales': [1, 2, 3]}`) -> Output: `6`

**Задача 11**
*   **Постановка задачи:** Написать функцию `get_data_shape`, которая возвращает размеры DataFrame в виде кортежа.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_data_shape(df):
        shape = df. ...
        return shape

    # --- Код для проверки ---
    data = {'col1': range(10), 'col2': range(10), 'col3': range(10)}
    df = pd.DataFrame(data)
    print(get_data_shape(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_data_shape(df):
        shape = df.shape
        return shape

    # --- Код для проверки ---
    data = {'col1': range(10), 'col2': range(10), 'col3': range(10)}
    df = pd.DataFrame(data)
    print(get_data_shape(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде, 10 строк, 3 колонки) -> Output: `(10, 3)`
    *   **Тест 2:** (в коде изменить данные на `{'a': [1], 'b': [1]}`) -> Output: `(1, 2)`

**Задача 12**
*   **Постановка задачи:** Написать функцию `get_last_n_rows`, которая принимает DataFrame и `n`, и возвращает последние `n` строк.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_last_n_rows(df, n):
        last_rows = df. ... (n)
        return last_rows

    # --- Код для проверки ---
    data = {'id': range(10)}
    df = pd.DataFrame(data)
    n_rows = int(input())
    print(get_last_n_rows(df, n_rows))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_last_n_rows(df, n):
        last_rows = df.tail(n)
        return last_rows

    # --- Код для проверки ---
    data = {'id': range(10)}
    df = pd.DataFrame(data)
    n_rows = int(input())
    print(get_last_n_rows(df, n_rows))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `3` -> Output: `   id\n7   7\n8   8\n9   9`
    *   **Тест 2:** Input: `1` -> Output: `   id\n9   9`

**Задача 13**
*   **Постановка задачи:** Написать функцию `get_unique_values`, которая возвращает массив уникальных значений столбца 'category'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_unique_values(df):
        unique_items = df['category']. ... ()
        return unique_items

    # --- Код для проверки ---
    data = {'category': ['A', 'B', 'A', 'C', 'B', 'A']}
    df = pd.DataFrame(data)
    print(get_unique_values(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_unique_values(df):
        unique_items = df['category'].unique()
        return unique_items

    # --- Код для проверки ---
    data = {'category': ['A', 'B', 'A', 'C', 'B', 'A']}
    df = pd.DataFrame(data)
    print(get_unique_values(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `['A' 'B' 'C']`
    *   **Тест 2:** (в коде изменить данные на `{'category': ['X', 'X']}`) -> Output: `['X']`

**Задача 14**
*   **Постановка задачи:** Написать функцию `get_bar_chart_data`, которая возвращает Series с суммой продаж ('sales') для каждого города ('city').
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_bar_chart_data(df):
        bar_data = df.groupby('city')['sales']. ... ()
        return bar_data

    # --- Код для проверки ---
    data = {'city': ['A', 'B', 'A'], 'sales': [500, 300, 100]}
    df = pd.DataFrame(data)
    print(get_bar_chart_data(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_bar_chart_data(df):
        bar_data = df.groupby('city')['sales'].sum()
        return bar_data

    # --- Код для проверки ---
    data = {'city': ['A', 'B', 'A'], 'sales': [500, 300, 100]}
    df = pd.DataFrame(data)
    print(get_bar_chart_data(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `city\nA    600\nB    300\nName: sales, dtype: int64`
    *   **Тест 2:** (в коде изменить `sales` на `[10, 20, 30]`) -> Output: `city\nA    40\nB    20\nName: sales, dtype: int64`

**Задача 15**
*   **Постановка задачи:** Написать функцию `select_two_columns`, которая возвращает DataFrame только со столбцами 'product' и 'revenue'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def select_two_columns(df):
        selected_data = df[[..., ...]]
        return selected_data

    # --- Код для проверки ---
    data = {'product': ['A', 'B'], 'revenue': [1000, 2000], 'cost': [600, 1200]}
    df = pd.DataFrame(data)
    print(select_two_columns(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def select_two_columns(df):
        selected_data = df[['product', 'revenue']]
        return selected_data

    # --- Код для проверки ---
    data = {'product': ['A', 'B'], 'revenue': [1000, 2000], 'cost': [600, 1200]}
    df = pd.DataFrame(data)
    print(select_two_columns(df))
    ```*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `  product  revenue\n0       A     1000\n1       B     2000`
    *   **Тест 2:** (в коде добавить еще одну строку) -> Output: (таблица с 3 строками и 2 столбцами)

***

### **Тема 3. Анализ временных рядов и подготовка признаков**

**Задача 1**
*   **Постановка задачи:** Написать функцию `convert_date_column`, которая преобразует столбец 'date_str' в datetime.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def convert_date_column(df):
        df['date'] = pd.to_datetime(df['...'])
        return df

    # --- Код для проверки ---
    dates_str = input().split(',')
    data = {'date_str': dates_str}
    df = pd.DataFrame(data)
    print(convert_date_column(df)['date'].dtype)
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def convert_date_column(df):
        df['date'] = pd.to_datetime(df['date_str'])
        return df

    # --- Код для проверки ---
    dates_str = input().split(',')
    data = {'date_str': dates_str}
    df = pd.DataFrame(data)
    print(convert_date_column(df)['date'].dtype)
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `2023-01-01,2023-01-02` -> Output: `datetime64[ns]`
    *   **Тест 2:** Input: `11/20/2023` -> Output: `datetime64[ns]`

**Задача 2**
*   **Постановка задачи:** Написать функцию `set_date_index`, которая устанавливает столбец 'date' в качестве индекса.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def set_date_index(df):
        df_indexed = df.set_index('...')
        return df_indexed

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-01-01', '2023-01-02']), 'sales': [100, 110]}
    df = pd.DataFrame(data)
    print(set_date_index(df).index)
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def set_date_index(df):
        df_indexed = df.set_index('date')
        return df_indexed

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-01-01', '2023-01-02']), 'sales': [100, 110]}
    df = pd.DataFrame(data)
    print(set_date_index(df).index)
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `DatetimeIndex(['2023-01-01', '2023-01-02'], dtype='datetime64[ns]', name='date', freq=None)`
    *   **Тест 2:** (в коде изменить данные на `{'date': pd.to_datetime(['2024-01-01'])}`) -> Output: `DatetimeIndex(['2024-01-01'], dtype='datetime64[ns]', name='date', freq=None)`

**Задача 3**
*   **Постановка задачи:** Написать функцию `extract_month`, которая возвращает Series с номером месяца из столбца 'date'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def extract_month(df):
        month_series = df['date'].dt. ...
        return month_series

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-11-20', '2023-12-05'])}
    df = pd.DataFrame(data)
    print(extract_month(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def extract_month(df):
        month_series = df['date'].dt.month
        return month_series

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-11-20', '2023-12-05'])}
    df = pd.DataFrame(data)
    print(extract_month(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0    11\n1    12\nName: date, dtype: int32`
    *   **Тест 2:** (в коде изменить данные на `{'date': pd.to_datetime(['2023-01-01'])}`) -> Output: `0    1\nName: date, dtype: int32`

**Задача 4**
*   **Постановка задачи:** Написать функцию `calculate_rolling_mean`, которая возвращает скользящее среднее для столбца 'sales' с окном 3.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def calculate_rolling_mean(df):
        rolling_mean = df['sales'].rolling(window=...).mean()
        return rolling_mean

    # --- Код для проверки ---
    data = {'sales': [10, 12, 11, 15, 14, 18]}
    df = pd.DataFrame(data)
    print(calculate_rolling_mean(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def calculate_rolling_mean(df):
        rolling_mean = df['sales'].rolling(window=3).mean()
        return rolling_mean

    # --- Код для проверки ---
    data = {'sales': [10, 12, 11, 15, 14, 18]}
    df = pd.DataFrame(data)
    print(calculate_rolling_mean(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0          NaN\n1          NaN\n2    11.000...\n3    12.666...\n4    13.333...\n5    15.666...\nName: sales, dtype: float64`
    *   **Тест 2:** (в коде изменить данные на `{'sales': [2, 4, 6, 8]}`) -> Output: `0    NaN\n1    NaN\n2    4.0\n3    6.0\nName: sales, dtype: float64`

**Задача 5**
*   **Постановка задачи:** Написать функцию `create_lag_feature`, которая создает лаг-признак (сдвиг на 1) для столбца 'sales'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def create_lag_feature(df):
        lag_feature = df['sales']. ... (1)
        return lag_feature

    # --- Код для проверки ---
    data = {'sales': [10, 12, 11, 15]}
    df = pd.DataFrame(data)
    print(create_lag_feature(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def create_lag_feature(df):
        lag_feature = df['sales'].shift(1)
        return lag_feature

    # --- Код для проверки ---
    data = {'sales': [10, 12, 11, 15]}
    df = pd.DataFrame(data)
    print(create_lag_feature(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0     NaN\n1    10.0\n2    12.0\n3    11.0\nName: sales, dtype: float64`
    *   **Тест 2:** (в коде изменить данные на `{'sales': [1, 2]}`) -> Output: `0    NaN\n1    1.0\nName: sales, dtype: float64`

**Задача 6**
*   **Постановка задачи:** Написать функцию `one_hot_encode`, которая возвращает DataFrame с фиктивными переменными для столбца 'city'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def one_hot_encode(df):
        dummies = pd.get_dummies(df['...'])
        return dummies

    # --- Код для проверки ---
    data = {'city': ['Москва', 'СПб', 'Казань', 'Москва']}
    df = pd.DataFrame(data)
    print(one_hot_encode(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def one_hot_encode(df):
        dummies = pd.get_dummies(df['city'])
        return dummies

    # --- Код для проверки ---
    data = {'city': ['Москва', 'СПб', 'Казань', 'Москва']}
    df = pd.DataFrame(data)
    print(one_hot_encode(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `   Казань  Москва    СПб\n0   False    True  False\n1   False   False   True\n2    True   False  False\n3   False    True  False`
    *   **Тест 2:** (в коде изменить данные на `{'city': ['A', 'B']}`) -> Output: `       A      B\n0   True  False\n1  False   True`

**Задача 7**
*   **Постановка задачи:** Написать функцию `resample_to_weekly`, которая выполняет ресэмплинг продаж в недельные суммы.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def resample_to_weekly(df):
        weekly_sales = df['sales'].resample('...').sum()
        return weekly_sales

    # --- Код для проверки ---
    dates = pd.date_range(start='2023-01-01', periods=10)
    data = {'sales': range(10)}
    df = pd.DataFrame(data, index=dates)
    print(resample_to_weekly(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def resample_to_weekly(df):
        weekly_sales = df['sales'].resample('W').sum()
        return weekly_sales

    # --- Код для проверки ---
    dates = pd.date_range(start='2023-01-01', periods=10)
    data = {'sales': range(10)}
    df = pd.DataFrame(data, index=dates)
    print(resample_to_weekly(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `2023-01-01    28\n2023-01-08    17\nFreq: W-SUN, Name: sales, dtype: int64`
    *   **Тест 2:** (в коде изменить `periods` на `7`) -> Output: `2023-01-01    21\nFreq: W-SUN, Name: sales, dtype: int64`

**Задача 8**
*   **Постановка задачи:** Написать функцию `extract_weekday`, которая возвращает Series с номером дня недели (0 - пн).
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def extract_weekday(df):
        weekday_series = df['date'].dt. ...
        return weekday_series

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-11-20', '2023-11-21'])}
    df = pd.DataFrame(data)
    print(extract_weekday(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def extract_weekday(df):
        weekday_series = df['date'].dt.dayofweek
        return weekday_series

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-11-20', '2023-11-21'])}
    df = pd.DataFrame(data)
    print(extract_weekday(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде, пн и вт) -> Output: `0    0\n1    1\nName: date, dtype: int32`
    *   **Тест 2:** (в коде изменить даты на `['2023-11-26', '2023-11-27']`, вс и пн) -> Output: `0    6\n1    0\nName: date, dtype: int32`


**Задача 9**

не работает

**Задача 10**
*   **Постановка задачи:** Написать функцию `calculate_pct_change`, которая рассчитывает процентное изменение для 'sales'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def calculate_pct_change(df):
        pct_change_series = df['sales']. ... ()
        return pct_change_series

    # --- Код для проверки ---
    data = {'sales': [100, 110, 105, 126]}
    df = pd.DataFrame(data)
    print(calculate_pct_change(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def calculate_pct_change(df):
        pct_change_series = df['sales'].pct_change()
        return pct_change_series

    # --- Код для проверки ---
    data = {'sales': [100, 110, 105, 126]}
    df = pd.DataFrame(data)
    print(calculate_pct_change(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0         NaN\n1    0.100...\n2   -0.045...\n3    0.200...\nName: sales, dtype: float64`
    *   **Тест 2:** (в коде изменить данные на `{'sales': [10, 20, 10]}`) -> Output: `0    NaN\n1    1.0\n2   -0.5\nName: sales, dtype: float64`

**Задача 11**
*   **Постановка задачи:** Написать функцию `filter_by_year`, которая возвращает данные за указанный год.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def filter_by_year(df, year):
        df_filtered = df[df.index.year == ...]
        return df_filtered

    # --- Код для проверки ---
    dates = pd.to_datetime(['2022-12-31', '2023-01-01', '2023-01-02'])
    df = pd.DataFrame({'val': [1, 2, 3]}, index=dates)
    year_to_filter = int(input())
    print(filter_by_year(df, year_to_filter))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def filter_by_year(df, year):
        df_filtered = df[df.index.year == year]
        return df_filtered

    # --- Код для проверки ---
    dates = pd.to_datetime(['2022-12-31', '2023-01-01', '2023-01-02'])
    df = pd.DataFrame({'val': [1, 2, 3]}, index=dates)
    year_to_filter = int(input())
    print(filter_by_year(df, year_to_filter))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `2023` -> Output: `            val\n2023-01-01    2\n2023-01-02    3`
    *   **Тест 2:** Input: `2022` -> Output: `            val\n2022-12-31    1`

**Задача 12**
*   **Постановка задачи:** Написать функцию `extract_quarter`, которая возвращает Series с номером квартала.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def extract_quarter(df):
        quarter_series = df['date'].dt. ...
        return quarter_series

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-02-15', '2023-08-15'])}
    df = pd.DataFrame(data)
    print(extract_quarter(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def extract_quarter(df):
        quarter_series = df['date'].dt.quarter
        return quarter_series

    # --- Код для проверки ---
    data = {'date': pd.to_datetime(['2023-02-15', '2023-08-15'])}
    df = pd.DataFrame(data)
    print(extract_quarter(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0    1\n1    3\nName: date, dtype: int32`
    *   **Тест 2:** (в коде изменить даты на `['2023-05-01', '2023-11-01']`) -> Output: `0    2\n1    4\nName: date, dtype: int32`

**Задача 13**
*   **Постановка задачи:** Написать функцию `min_max_scale`, которая применяет Min-Max масштабирование к столбцу 'price'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    from sklearn.preprocessing import MinMaxScaler
    def min_max_scale(df):
        scaler = MinMaxScaler()
        df['price_scaled'] = scaler.fit_transform(df[['...']])
        return df

    # --- Код для проверки ---
    data = {'price': [100, 200, 500, 50]}
    df = pd.DataFrame(data)
    print(min_max_scale(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    from sklearn.preprocessing import MinMaxScaler
    def min_max_scale(df):
        scaler = MinMaxScaler()
        df['price_scaled'] = scaler.fit_transform(df[['price']])
        return df

    # --- Код для проверки ---
    data = {'price': [100, 200, 500, 50]}
    df = pd.DataFrame(data)
    print(min_max_scale(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `   price  price_scaled\n0    100      0.111...\n1    200      0.333...\n2    500      1.000...\n3     50      0.000...`
    *   **Тест 2:** (в коде изменить данные на `{'price': [10, 20, 30]}`) -> Output: `   price  price_scaled\n0     10           0.0\n1     20           0.5\n2     30           1.0`

**Задача 14**
*   **Постановка задачи:** Написать функцию `standard_scale`, которая применяет стандартизацию к столбцу 'values'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    from sklearn.preprocessing import StandardScaler
    def standard_scale(df):
        scaler = StandardScaler()
        df['values_scaled'] = scaler.fit_transform(df[['...']])
        return df

    # --- Код для проверки ---
    data = {'values': [10, 20, 30, 40, 50]}
    df = pd.DataFrame(data)
    print(standard_scale(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    from sklearn.preprocessing import StandardScaler
    def standard_scale(df):
        scaler = StandardScaler()
        df['values_scaled'] = scaler.fit_transform(df[['values']])
        return df

    # --- Код для проверки ---
    data = {'values': [10, 20, 30, 40, 50]}
    df = pd.DataFrame(data)
    print(standard_scale(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `   values  values_scaled\n0      10      -1.414...\n1      20      -0.707...\n2      30       0.000...\n3      40       0.707...\n4      50       1.414...`
    *   **Тест 2:** (в коде изменить данные на `{'values': [0, 10]}`) -> Output: `   values  values_scaled\n0       0           -1.0\n1      10            1.0`

**Задача 15**
*   **Постановка задачи:** Написать функцию `get_date_diff`, которая вычисляет разницу в днях между 'date2' и 'date1'.
*   **Шаблон для написания кода:**
    ```python
    import pandas as pd
    def get_date_diff(df):
        diff_days = (df['date2'] - df['date1']).dt. ...
        return diff_days

    # --- Код для проверки ---
    data = {'date1': pd.to_datetime(['2023-01-01', '2023-02-10']),
            'date2': pd.to_datetime(['2023-01-10', '2023-02-20'])}
    df = pd.DataFrame(data)
    print(get_date_diff(df))
    ```
*   **Решение для преподавателя:**
    ```python
    import pandas as pd
    def get_date_diff(df):
        diff_days = (df['date2'] - df['date1']).dt.days
        return diff_days

    # --- Код для проверки ---
    data = {'date1': pd.to_datetime(['2023-01-01', '2023-02-10']),
            'date2': pd.to_datetime(['2023-01-10', '2023-02-20'])}
    df = pd.DataFrame(data)
    print(get_date_diff(df))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `0     9\n1    10\ndtype: int64`
    *   **Тест 2:** (в коде изменить 'date2' на `['2023-01-02', '2023-03-10']`) -> Output: `0     1\n1    28\ndtype: int64`

***

### **Тема 4. Построение и оценка предиктивных моделей**

**Задача 1**
*   **Постановка задачи:** Написать функцию `split_data`, которая делит данные на обучающую и тестовую выборки с `test_size=0.25`.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.model_selection import train_test_split
    import numpy as np
    def split_data(X, y):
        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=..., random_state=42)
        return X_train, X_test, y_train, y_test

    # --- Код для проверки ---
    n_samples = int(input())
    X = np.arange(n_samples).reshape(-1, 1)
    y = np.arange(n_samples)
    X_tr, X_te, _, _ = split_data(X, y)
    print(len(X_tr), len(X_te))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.model_selection import train_test_split
    import numpy as np
    def split_data(X, y):
        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)
        return X_train, X_test, y_train, y_test

    # --- Код для проверки ---
    n_samples = int(input())
    X = np.arange(n_samples).reshape(-1, 1)
    y = np.arange(n_samples)
    X_tr, X_te, _, _ = split_data(X, y)
    print(len(X_tr), len(X_te))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `12` -> Output: `9 3`
    *   **Тест 2:** Input: `20` -> Output: `15 5`

**Задача 2**
*   **Постановка задачи:** Написать функцию `train_linear_regression`, которая обучает модель линейной регрессии.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.linear_model import LinearRegression
    import numpy as np
    def train_linear_regression(X_train, y_train):
        model = LinearRegression()
        model. ... (X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[10], [20], [30]])
    y = np.array([100, 200, 300])
    trained_model = train_linear_regression(X, y)
    print(trained_model.coef_)
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.linear_model import LinearRegression
    import numpy as np
    def train_linear_regression(X_train, y_train):
        model = LinearRegression()
        model.fit(X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[10], [20], [30]])
    y = np.array([100, 200, 300])
    trained_model = train_linear_regression(X, y)
    print(trained_model.coef_)
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `[10.]`
    *   **Тест 2:** (в коде изменить `y` на `[20, 40, 60]`) -> Output: `[2.]`

**Задача 3**
*   **Постановка задачи:** Написать функцию `make_prediction`, которая делает предсказание с помощью обученной модели.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.linear_model import LinearRegression
    import numpy as np
    def make_prediction(model, X_test):
        prediction = model. ... (X_test)
        return prediction

    # --- Код для проверки ---
    model = LinearRegression()
    model.fit(np.array([[10], [20]]), np.array([100, 200]))
    X_to_predict = np.array([[30], [40]])
    print(make_prediction(model, X_to_predict))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.linear_model import LinearRegression
    import numpy as np
    def make_prediction(model, X_test):
        prediction = model.predict(X_test)
        return prediction

    # --- Код для проверки ---
    model = LinearRegression()
    model.fit(np.array([[10], [20]]), np.array([100, 200]))
    X_to_predict = np.array([[30], [40]])
    print(make_prediction(model, X_to_predict))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `[300. 400.]`
    *   **Тест 2:** (в коде изменить `X_to_predict` на `[[5]]`) -> Output: `[50.]`

**Задача 4**
*   **Постановка задачи:** Написать функцию `calculate_mae`, которая считает метрику MAE.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import mean_absolute_error
    def calculate_mae(y_true, y_pred):
        mae = mean_absolute_error(y_true, ...)
        return mae

    # --- Код для проверки ---
    y_true_in = [float(x) for x in input().split()]
    y_pred_in = [float(x) for x in input().split()]
    print(calculate_mae(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import mean_absolute_error
    def calculate_mae(y_true, y_pred):
        mae = mean_absolute_error(y_true, y_pred)
        return mae

    # --- Код для проверки ---
    y_true_in = [float(x) for x in input().split()]
    y_pred_in = [float(x) for x in input().split()]
    print(calculate_mae(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `10 20 30\n12 18 33` -> Output: `2.333...`
    *   **Тест 2:** Input: `1 2 3\n1 2 4` -> Output: `0.333...`

**Задача 5**
*   **Постановка задачи:** Написать функцию `calculate_accuracy` для расчета метрики Accuracy.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import accuracy_score
    def calculate_accuracy(y_true, y_pred):
        accuracy = accuracy_score(..., y_pred)
        return accuracy

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_accuracy(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import accuracy_score
    def calculate_accuracy(y_true, y_pred):
        accuracy = accuracy_score(y_true, y_pred)
        return accuracy

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_accuracy(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `0 1 1 0\n0 1 0 0` -> Output: `0.75`
    *   **Тест 2:** Input: `1 1 1 1\n1 0 1 0` -> Output: `0.5`

**Задача 6**
*   **Постановка задачи:** Написать функцию `calculate_mse` для расчета метрики MSE.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import mean_squared_error
    def calculate_mse(y_true, y_pred):
        mse = mean_squared_error(y_true, ...)
        return mse

    # --- Код для проверки ---
    y_true_in = [float(x) for x in input().split()]
    y_pred_in = [float(x) for x in input().split()]
    print(calculate_mse(y_true_in, y_pred_in))
    ```*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import mean_squared_error
    def calculate_mse(y_true, y_pred):
        mse = mean_squared_error(y_true, y_pred)
        return mse

    # --- Код для проверки ---
    y_true_in = [float(x) for x in input().split()]
    y_pred_in = [float(x) for x in input().split()]
    print(calculate_mse(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `1 2 3\n1.5 2.5 3.5` -> Output: `0.25`
    *   **Тест 2:** Input: `10 20\n10 30` -> Output: `50.0`

**Задача 7**
*   **Постановка задачи:** Написать функцию `get_confusion_matrix`, которая возвращает матрицу ошибок.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import confusion_matrix
    def get_confusion_matrix(y_true, y_pred):
        cm = confusion_matrix(..., y_pred)
        return cm

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(get_confusion_matrix(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import confusion_matrix
    def get_confusion_matrix(y_true, y_pred):
        cm = confusion_matrix(y_true, y_pred)
        return cm

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(get_confusion_matrix(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `0 1 0 1\n1 1 0 0` -> Output: `[[1 1]\n [1 1]]`
    *   **Тест 2:** Input: `0 0 1 1\n0 0 1 1` -> Output: `[[2 0]\n [0 2]]`

**Задача 8**
*   **Постановка задачи:** Написать функцию `calculate_r2`, которая возвращает метрику R².
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import r2_score
    def calculate_r2(y_true, y_pred):
        r2 = r2_score(y_true, ...)
        return r2

    # --- Код для проверки ---
    y_true_in = [float(x) for x in input().split()]
    y_pred_in = [float(x) for x in input().split()]
    print(calculate_r2(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import r2_score
    def calculate_r2(y_true, y_pred):
        r2 = r2_score(y_true, y_pred)
        return r2

    # --- Код для проверки ---
    y_true_in = [float(x) for x in input().split()]
    y_pred_in = [float(x) for x in input().split()]
    print(calculate_r2(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `3 0.5 2 7\n2.5 0.0 2 8` -> Output: `0.948...`
    *   **Тест 2:** Input: `1 2 3\n1 2 3` -> Output: `1.0`

**Задача 9**
*   **Постановка задачи:** Написать функцию `calculate_precision`, которая возвращает метрику Precision.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import precision_score
    def calculate_precision(y_true, y_pred):
        precision = precision_score(y_true, ...)
        return precision

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_precision(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import precision_score
    def calculate_precision(y_true, y_pred):
        precision = precision_score(y_true, y_pred)
        return precision

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_precision(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `0 1 0 1\n0 1 1 1` -> Output: `0.666...`
    *   **Тест 2:** Input: `1 1 1\n1 1 0` -> Output: `1.0`

**Задача 10**
*   **Постановка задачи:** Написать функцию `calculate_recall`, которая возвращает метрику Recall.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import recall_score
    def calculate_recall(y_true, y_pred):
        recall = recall_score(y_true, ...)
        return recall

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_recall(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import recall_score
    def calculate_recall(y_true, y_pred):
        recall = recall_score(y_true, y_pred)
        return recall

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_recall(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `0 1 1 0\n0 0 1 1` -> Output: `0.5`
    *   **Тест 2:** Input: `1 1 0 0\n1 1 0 0` -> Output: `1.0`

**Задача 11**
*   **Постановка задачи:** Написать функцию `calculate_f1_score`, которая возвращает метрику F1-score.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.metrics import f1_score
    def calculate_f1_score(y_true, y_pred):
        f1 = f1_score(y_true, ...)
        return f1

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_f1_score(y_true_in, y_pred_in))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.metrics import f1_score
    def calculate_f1_score(y_true, y_pred):
        f1 = f1_score(y_true, y_pred)
        return f1

    # --- Код для проверки ---
    y_true_in = [int(x) for x in input().split()]
    y_pred_in = [int(x) for x in input().split()]
    print(calculate_f1_score(y_true_in, y_pred_in))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: `0 1 1 0\n0 0 1 1` -> Output: `0.5`
    *   **Тест 2:** Input: `0 1 0 1\n0 1 0 1` -> Output: `1.0`

**Задача 12**
*   **Постановка задачи:** Написать функцию `train_logistic_regression`, которая обучает модель логистической регрессии.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.linear_model import LogisticRegression
    import numpy as np
    def train_logistic_regression(X_train, y_train):
        model = LogisticRegression()
        model. ... (X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[-2], [-1], [1], [2]])
    y = np.array([0, 0, 1, 1])
    trained_model = train_logistic_regression(X, y)
    print(trained_model.classes_)
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.linear_model import LogisticRegression
    import numpy as np
    def train_logistic_regression(X_train, y_train):
        model = LogisticRegression()
        model.fit(X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[-2], [-1], [1], [2]])
    y = np.array([0, 0, 1, 1])
    trained_model = train_logistic_regression(X, y)
    print(trained_model.classes_)
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `[0 1]`
    *   **Тест 2:** (в коде изменить `y` на `[1, 1, 0, 0]`) -> Output: `[0 1]`

**Задача 13**
*   **Постановка задачи:** Написать функцию `get_probabilities`, которая возвращает предсказанные вероятности классов.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.linear_model import LogisticRegression
    import numpy as np
    def get_probabilities(model, X_test):
        probabilities = model. ... (X_test)
        return probabilities

    # --- Код для проверки ---
    model = LogisticRegression()
    model.fit(np.array([[-10], [10]]), np.array([0, 1]))
    X_to_predict = np.array([[-5], [0], [5]])
    print(get_probabilities(model, X_to_predict))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.linear_model import LogisticRegression
    import numpy as np
    def get_probabilities(model, X_test):
        probabilities = model.predict_proba(X_test)
        return probabilities

    # --- Код для проверки ---
    model = LogisticRegression()
    model.fit(np.array([[-10], [10]]), np.array([0, 1]))
    X_to_predict = np.array([[-5], [0], [5]])
    print(get_probabilities(model, X_to_predict))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде) -> Output: `[[9.9...e-01 8.2...e-04]\n [5.0...e-01 4.9...e-01]\n [1.7...e-04 9.9...e-01]]`
    *   **Тест 2:** (в коде изменить `X_to_predict` на `[[-20]]`) -> Output: `[[1. 0.]]`

**Задача 14**
*   **Постановка задачи:** Написать функцию `train_knn`, которая обучает модель k-ближайших соседей с `k=3`.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.neighbors import KNeighborsClassifier
    import numpy as np
    def train_knn(X_train, y_train):
        model = KNeighborsClassifier(n_neighbors=...)
        model.fit(X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[0], [1], [2], [10], [11], [12]])
    y = np.array([0, 0, 0, 1, 1, 1])
    trained_model = train_knn(X, y)
    print(trained_model.predict([[5]]))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.neighbors import KNeighborsClassifier
    import numpy as np
    def train_knn(X_train, y_train):
        model = KNeighborsClassifier(n_neighbors=3)
        model.fit(X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[0], [1], [2], [10], [11], [12]])
    y = np.array([0, 0, 0, 1, 1, 1])
    trained_model = train_knn(X, y)
    print(trained_model.predict([[5]]))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде, предсказание для `[[5]]`) -> Output: `[0]`
    *   **Тест 2:** (в том же коде изменить предсказание на `[[9]]`) -> Output: `[1]`

**Задача 15**
*   **Постановка задачи:** Написать функцию `train_decision_tree`, которая обучает модель дерева решений для регрессии.
*   **Шаблон для написания кода:**
    ```python
    from sklearn.tree import DecisionTreeRegressor
    import numpy as np
    def train_decision_tree(X_train, y_train):
        model = DecisionTreeRegressor(random_state=42)
        model. ... (X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[1], [2], [10], [11]])
    y = np.array([10, 10, 100, 100])
    trained_model = train_decision_tree(X, y)
    print(trained_model.predict([[5]]))
    ```
*   **Решение для преподавателя:**
    ```python
    from sklearn.tree import DecisionTreeRegressor
    import numpy as np
    def train_decision_tree(X_train, y_train):
        model = DecisionTreeRegressor(random_state=42)
        model.fit(X_train, y_train)
        return model

    # --- Код для проверки ---
    X = np.array([[1], [2], [10], [11]])
    y = np.array([10, 10, 100, 100])
    trained_model = train_decision_tree(X, y)
    print(trained_model.predict([[5]]))
    ```
*   **Тесты:**
    *   **Тест 1:** Input: (данные в коде, предсказание для `[[5]]`) -> Output: `[10.]`
    *   **Тест 2:** (в том же коде изменить предсказание на `[[12]]`) -> Output: `[100.]`
